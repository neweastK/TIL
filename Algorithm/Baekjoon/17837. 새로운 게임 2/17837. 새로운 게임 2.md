## üêå ÏïåÍ≥†Î¶¨Ï¶ò Î¨∏Ï†ú ÌíÄÏù¥

### Baekjoon_17837. ÏÉàÎ°úÏö¥ Í≤åÏûÑ 2

#### üìíÎ¨∏Ï†ú

> Ïû¨ÌòÑÏù¥Îäî Ï£ºÎ≥ÄÏùÑ ÏÇ¥Ìé¥Î≥¥Îçò Ï§ë Ï≤¥Ïä§ÌåêÍ≥º ÎßêÏùÑ Ïù¥Ïö©Ìï¥ÏÑú ÏÉàÎ°úÏö¥ Í≤åÏûÑÏùÑ ÎßåÎì§Í∏∞Î°ú ÌñàÎã§. ÏÉàÎ°úÏö¥ Í≤åÏûÑÏùÄ ÌÅ¨Í∏∞Í∞Ä N√óNÏù∏ Ï≤¥Ïä§ÌåêÏóêÏÑú ÏßÑÌñâÎêòÍ≥†, ÏÇ¨Ïö©ÌïòÎäî ÎßêÏùò Í∞úÏàòÎäî KÍ∞úÏù¥Îã§. ÎßêÏùÄ ÏõêÌåêÎ™®ÏñëÏù¥Í≥†, ÌïòÎÇòÏùò Îßê ÏúÑÏóê Îã§Î•∏ ÎßêÏùÑ Ïò¨Î¶¥ Ïàò ÏûàÎã§. Ï≤¥Ïä§ÌåêÏùò Í∞Å Ïπ∏ÏùÄ Ìù∞ÏÉâ, Îπ®Í∞ÑÏÉâ, ÌååÎûÄÏÉâ Ï§ë ÌïòÎÇòÎ°ú ÏÉâÏπ†ÎêòÏñ¥ÏûàÎã§.
>
> Í≤åÏûÑÏùÄ Ï≤¥Ïä§Ìåê ÏúÑÏóê Îßê KÍ∞úÎ•º ÎÜìÍ≥† ÏãúÏûëÌïúÎã§. ÎßêÏùÄ 1Î≤àÎ∂ÄÌÑ∞ KÎ≤àÍπåÏßÄ Î≤àÌò∏Í∞Ä Îß§Í≤®Ï†∏ ÏûàÍ≥†, Ïù¥Îèô Î∞©Ìñ•ÎèÑ ÎØ∏Î¶¨ Ï†ïÌï¥Ï†∏ ÏûàÎã§. Ïù¥Îèô Î∞©Ìñ•ÏùÄ ÏúÑ, ÏïÑÎûò, ÏôºÏ™Ω, Ïò§Î•∏Ï™Ω 4Í∞ÄÏßÄ Ï§ë ÌïòÎÇòÏù¥Îã§.
>
> ÌÑ¥ Ìïú Î≤àÏùÄ 1Î≤à ÎßêÎ∂ÄÌÑ∞ KÎ≤à ÎßêÍπåÏßÄ ÏàúÏÑúÎåÄÎ°ú Ïù¥ÎèôÏãúÌÇ§Îäî Í≤ÉÏù¥Îã§. Ìïú ÎßêÏù¥ Ïù¥ÎèôÌï† Îïå ÏúÑÏóê Ïò¨Î†§Ï†∏ ÏûàÎäî ÎßêÎèÑ Ìï®Íªò Ïù¥ÎèôÌïúÎã§. ÎßêÏùò Ïù¥Îèô Î∞©Ìñ•Ïóê ÏûàÎäî Ïπ∏Ïóê Îî∞ÎùºÏÑú ÎßêÏùò Ïù¥ÎèôÏù¥ Îã§Î•¥Î©∞ ÏïÑÎûòÏôÄ Í∞ôÎã§. ÌÑ¥Ïù¥ ÏßÑÌñâÎêòÎçò Ï§ëÏóê ÎßêÏù¥ 4Í∞ú Ïù¥ÏÉÅ ÏåìÏù¥Îäî ÏàúÍ∞Ñ Í≤åÏûÑÏù¥ Ï¢ÖÎ£åÎêúÎã§.
>
> - AÎ≤à ÎßêÏù¥ Ïù¥ÎèôÌïòÎ†§Îäî Ïπ∏Ïù¥
>   - Ìù∞ÏÉâÏù∏ Í≤ΩÏö∞ÏóêÎäî Í∑∏ Ïπ∏ÏúºÎ°ú Ïù¥ÎèôÌïúÎã§. Ïù¥ÎèôÌïòÎ†§Îäî Ïπ∏Ïóê ÎßêÏù¥ Ïù¥ÎØ∏ ÏûàÎäî Í≤ΩÏö∞ÏóêÎäî Í∞ÄÏû• ÏúÑÏóê AÎ≤à ÎßêÏùÑ Ïò¨Î†§ÎÜìÎäîÎã§.
>     - AÎ≤à ÎßêÏùò ÏúÑÏóê Îã§Î•∏ ÎßêÏù¥ ÏûàÎäî Í≤ΩÏö∞ÏóêÎäî AÎ≤à ÎßêÍ≥º ÏúÑÏóê ÏûàÎäî Î™®Îì† ÎßêÏù¥ Ïù¥ÎèôÌïúÎã§.
>     - ÏòàÎ•º Îì§Ïñ¥, A, B, CÎ°ú ÏåìÏó¨ÏûàÍ≥†, Ïù¥ÎèôÌïòÎ†§Îäî Ïπ∏Ïóê D, EÍ∞Ä ÏûàÎäî Í≤ΩÏö∞ÏóêÎäî AÎ≤à ÎßêÏù¥ Ïù¥ÎèôÌïú ÌõÑÏóêÎäî D, E, A, B, CÍ∞Ä ÎêúÎã§.
>   - Îπ®Í∞ÑÏÉâÏù∏ Í≤ΩÏö∞ÏóêÎäî Ïù¥ÎèôÌïú ÌõÑÏóê AÎ≤à ÎßêÍ≥º Í∑∏ ÏúÑÏóê ÏûàÎäî Î™®Îì† ÎßêÏùò ÏåìÏó¨ÏûàÎäî ÏàúÏÑúÎ•º Î∞òÎåÄÎ°ú Î∞îÍæºÎã§.
>     - A, B, CÍ∞Ä Ïù¥ÎèôÌïòÍ≥†, Ïù¥ÎèôÌïòÎ†§Îäî Ïπ∏Ïóê ÎßêÏù¥ ÏóÜÎäî Í≤ΩÏö∞ÏóêÎäî C, B, AÍ∞Ä ÎêúÎã§.
>     - A, D, F, GÍ∞Ä Ïù¥ÎèôÌïòÍ≥†, Ïù¥ÎèôÌïòÎ†§Îäî Ïπ∏Ïóê ÎßêÏù¥ E, C, BÎ°ú ÏûàÎäî Í≤ΩÏö∞ÏóêÎäî E, C, B, G, F, D, AÍ∞Ä ÎêúÎã§.
>   - ÌååÎûÄÏÉâÏù∏ Í≤ΩÏö∞ÏóêÎäî AÎ≤à ÎßêÏùò Ïù¥Îèô Î∞©Ìñ•ÏùÑ Î∞òÎåÄÎ°ú ÌïòÍ≥† Ìïú Ïπ∏ Ïù¥ÎèôÌïúÎã§. Î∞©Ìñ•ÏùÑ Î∞òÎåÄÎ°ú Î∞îÍæº ÌõÑÏóê Ïù¥ÎèôÌïòÎ†§Îäî Ïπ∏Ïù¥ ÌååÎûÄÏÉâÏù∏ Í≤ΩÏö∞ÏóêÎäî Ïù¥ÎèôÌïòÏßÄ ÏïäÍ≥† Í∞ÄÎßåÌûà ÏûàÎäîÎã§.
>   - Ï≤¥Ïä§ÌåêÏùÑ Î≤óÏñ¥ÎÇòÎäî Í≤ΩÏö∞ÏóêÎäî ÌååÎûÄÏÉâÍ≥º Í∞ôÏùÄ Í≤ΩÏö∞Ïù¥Îã§.
>
> Îã§ÏùåÏùÄ ÌÅ¨Í∏∞Í∞Ä 4√ó4Ïù∏ Ï≤¥Ïä§Ìåê ÏúÑÏóê ÎßêÏù¥ 4Í∞ú ÏûàÎäî Í≤ΩÏö∞Ïù¥Îã§.
>
> ![img](https://upload.acmicpc.net/0aec7e3d-e8f5-428a-bebc-6a0fd514b387/-/preview/)
>
> Ï≤´ Î≤àÏß∏ ÌÑ¥ÏùÄ Îã§ÏùåÍ≥º Í∞ôÏù¥ ÏßÑÌñâÎêúÎã§.
>
> | ![img](https://upload.acmicpc.net/46796304-b486-4420-9d2c-ea49e2d5665b/-/preview/) | ![img](https://upload.acmicpc.net/04643ced-fdfd-46f5-a07e-374704dbb1c5/-/preview/) | ![img](https://upload.acmicpc.net/46f4bfab-841b-41c8-842e-56027816f846/-/preview/) | ![img](https://upload.acmicpc.net/fcccf76c-9431-4ff5-8a05-7dbd2feff142/-/preview/) |
> | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
>
> Îëê Î≤àÏß∏ ÌÑ¥ÏùÄ Îã§ÏùåÍ≥º Í∞ôÏù¥ ÏßÑÌñâÎêúÎã§.
>
> | ![img](https://upload.acmicpc.net/36568153-8c2a-4fe9-b45f-72036c97f5aa/-/preview/) | ![img](https://upload.acmicpc.net/babead43-4acc-425d-917a-54dcc6f45414/-/preview/) | ![img](https://upload.acmicpc.net/1edd5ed8-0f4c-4c6d-b304-3b7642f42c6f/-/preview/) | ![img](https://upload.acmicpc.net/028a5dd2-5524-4475-8439-9e7794e28ee4/-/preview/) |
> | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
>
> Ï≤¥Ïä§ÌåêÏùò ÌÅ¨Í∏∞ÏôÄ ÎßêÏùò ÏúÑÏπò, Ïù¥Îèô Î∞©Ìñ•Ïù¥ Î™®Îëê Ï£ºÏñ¥Ï°åÏùÑ Îïå, Í≤åÏûÑÏù¥ Ï¢ÖÎ£åÎêòÎäî ÌÑ¥Ïùò Î≤àÌò∏Î•º Íµ¨Ìï¥Î≥¥Ïûê.
>
> [<Î¨∏Ï†ú Ï∂úÏ≤ò>](https://www.acmicpc.net/problem/17837)



#### :pushpin: ÏûÖÎ†• Î∞è Ï∂úÎ†•

- Ï≤´Ïß∏ Ï§ÑÏóê Ï≤¥Ïä§ÌåêÏùò ÌÅ¨Í∏∞ N, ÎßêÏùò Í∞úÏàò KÍ∞Ä Ï£ºÏñ¥ÏßÑÎã§. ÎëòÏß∏ Ï§ÑÎ∂ÄÌÑ∞ NÍ∞úÏùò Ï§ÑÏóê Ï≤¥Ïä§ÌåêÏùò Ï†ïÎ≥¥Í∞Ä Ï£ºÏñ¥ÏßÑÎã§. Ï≤¥Ïä§ÌåêÏùò Ï†ïÎ≥¥Îäî Ï†ïÏàòÎ°ú Ïù¥Î£®Ïñ¥Ï†∏ ÏûàÍ≥†, Í∞Å Ï†ïÏàòÎäî Ïπ∏Ïùò ÏÉâÏùÑ ÏùòÎØ∏ÌïúÎã§. 0ÏùÄ Ìù∞ÏÉâ, 1ÏùÄ Îπ®Í∞ÑÏÉâ, 2Îäî ÌååÎûÄÏÉâÏù¥Îã§.

  Îã§Ïùå KÍ∞úÏùò Ï§ÑÏóê ÎßêÏùò Ï†ïÎ≥¥Í∞Ä 1Î≤à ÎßêÎ∂ÄÌÑ∞ ÏàúÏÑúÎåÄÎ°ú Ï£ºÏñ¥ÏßÑÎã§. ÎßêÏùò Ï†ïÎ≥¥Îäî ÏÑ∏ Í∞úÏùò Ï†ïÏàòÎ°ú Ïù¥Î£®Ïñ¥Ï†∏ ÏûàÍ≥†, ÏàúÏÑúÎåÄÎ°ú Ìñâ, Ïó¥Ïùò Î≤àÌò∏, Ïù¥Îèô Î∞©Ìñ•Ïù¥Îã§. ÌñâÍ≥º Ïó¥Ïùò Î≤àÌò∏Îäî 1Î∂ÄÌÑ∞ ÏãúÏûëÌïòÍ≥†, Ïù¥Îèô Î∞©Ìñ•ÏùÄ 4Î≥¥Îã§ ÏûëÍ±∞ÎÇò Í∞ôÏùÄ ÏûêÏó∞ÏàòÏù¥Í≥† 1Î∂ÄÌÑ∞ ÏàúÏÑúÎåÄÎ°ú ‚Üí, ‚Üê, ‚Üë, ‚ÜìÏùò ÏùòÎØ∏Î•º Í∞ñÎäîÎã§.

  Í∞ôÏùÄ Ïπ∏Ïóê ÎßêÏù¥ Îëê Í∞ú Ïù¥ÏÉÅ ÏûàÎäî Í≤ΩÏö∞Îäî ÏûÖÎ†•ÏúºÎ°ú Ï£ºÏñ¥ÏßÄÏßÄ ÏïäÎäîÎã§.

- Í≤åÏûÑÏù¥ Ï¢ÖÎ£åÎêòÎäî ÌÑ¥Ïùò Î≤àÌò∏Î•º Ï∂úÎ†•ÌïúÎã§. Í∑∏ Í∞íÏù¥ 1,000Î≥¥Îã§ ÌÅ¨Í±∞ÎÇò Ï†àÎåÄÎ°ú Í≤åÏûÑÏù¥ Ï¢ÖÎ£åÎêòÏßÄ ÏïäÎäî Í≤ΩÏö∞ÏóêÎäî -1ÏùÑ Ï∂úÎ†•ÌïúÎã§.



---

> ÏòàÏãú

```
input :
4 4
0 0 2 0
0 0 1 0
0 0 1 2
0 2 0 0
2 1 1
3 2 3
2 2 1
4 1 2

output :
-1

input :
4 4
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0
1 1 1
1 2 1
1 3 1
1 4 1

output :
1

input :
4 4
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0
1 1 1
1 2 1
1 3 1
2 4 3

output :
1

input :
6 10
0 1 2 0 1 1
1 2 0 1 1 0
2 1 0 1 1 0
1 0 1 1 0 2
2 0 1 2 0 1
0 2 1 0 2 1
1 1 1
2 2 2
3 3 4
4 4 1
5 5 3
6 6 2
1 6 3
6 1 2
2 4 3
4 2 1

output :
7
```

----




#### üöÄpoint

1. ÎßêÏù¥ Í≤πÏ≥êÏ†∏ÏûàÎäî(ÏåìÏó¨ÏûàÎäî) Í≤ÉÏùÑ Ïñ¥ÎñªÍ≤å Íµ¨ÌòÑÌï† Í≤ÉÏù∏Í∞Ä?
   1. 3Ï∞®Ïõê Î∞∞Ïó¥ ÌôúÏö©






#### üîéÌíÄÏù¥

1.  ÎßêÏùò Ï†ïÎ≥¥Î•º Îã¥ÏùÑ Îëê Í∞úÏùò Î≥ÄÏàò ÏÑ†Ïñ∏
    1.  nodes Î∞∞Ïó¥ÏùÄ Ï¶âÏãú Í∞±Ïã†ÌïòÏßÄ ÏïäÏïÑÎèÑ ÎêòÎäî Í∞í
    1.  node_loc Í∞ùÏ≤¥Îäî Ïñ¥Îñ§ Ïù¥ÎèôÏù¥Îì† Ï¶âÏãú Í∞±Ïã†Ìï¥ÏïºÎêòÎäî Í∞í

1.  ÏûÖÎ†•Í∞íÏùÑ Î∞õÏúºÎ©¥ÏÑú Í∞Å Î≥ÄÏàòÏóê ÎßûÎäî Ï†ïÎ≥¥Î•º Ìï†Îãπ
    1.  nodes Î∞∞Ïó¥ÏóêÎäî Îßê Î≤àÌò∏, ÎßêÏùò Î∞©Ìñ•, ÌååÎûë(ÌòπÏùÄ Î∞îÍπ• Î≤îÏúÑ) Î∞òÎ≥µ Ïó¨Î∂Ä
    1.  node_loc Í∞ùÏ≤¥ÏóêÎäî Ìñâ ÏúÑÏπò, Ïó¥ ÏúÑÏπò, Ï∏µ

1.  arr Î∞∞Ïó¥ÏùÄ Í≤åÏûÑÌåêÏóê Í∞Å Ïπ∏Ïùò ÏÉÅÌÉúÎ•º ÎÇòÌÉÄÎÇ¥Îäî Î∞∞Ïó¥
1.  arr_nodeÎäî Í∞Å ÎßêÏù¥ Ïñ¥Îñ§ Í≤åÏûÑÌåêÏóê ÏúÑÏπòÌïòÍ≥† ÏûàÎäîÏßÄ ÎÇòÌÉÄÎÇ¥Îäî 3Ï∞®Ïõê Î∞∞Ïó¥
    1.  Í≤πÏ≥êÏûàÎäî Í≤ΩÏö∞, ÏúÑ Ï∏µÏúºÎ°ú Î≥¥ÎÇ∏Îã§
    1.  Ï¥àÍ∏∞ÏóêÎäî Í≤πÏ≥êÏûàÎäî Í≤ΩÏö∞Í∞Ä ÏóÜÏúºÎØÄÎ°ú ÏûÖÎ†•Í∞í Í∑∏ÎåÄÎ°ú 0Ï∏µÏóê Ìï¥Îãπ Îßê Î≤àÌò∏Î•º ÏûÖÎ†•ÌïúÎã§

1.  deltaÎäî Í∞Å Î∞©Ìñ•Ïóê ÎßûÍ≤å Ïù¥ÎèôÌïòÎäî Ïù¥Îèô Î∞©Ìñ•
1.  nodeÎ•º ÏàúÌöåÌïòÎäîÎç∞ Ïù¥Îïå, dequeÎ•º Ïù¥Ïö©ÌïúÎã§
    1.  ÎßåÏïΩ, ÌååÎûëÏù¥ÎÇò Î≤îÏúÑ Î∞ñÏúºÎ°ú Ïù¥ÎèôÌïú Í≤ΩÏö∞ Ìï¥Îãπ ÎßêÏùÑ Î∞îÎ°ú Îã§Ïãú ÌôïÏù∏Ìï¥ÏïºÌïòÍ∏∞ ÎïåÎ¨∏
    1.  Îã®Ïàú forÎ¨∏ÏùÑ ÏÇ¨Ïö©ÌïòÎ©¥ Ï¶âÏãú Í∑∏ ÎßêÏùÑ Îã§Ïãú Ï≤¥ÌÅ¨Ìï† Ïàò ÏóÜÏùå

1.  popleftÎ°ú ÌïòÎÇòÏùò Îßê Ï†ïÎ≥¥Î•º Î∞òÌôò
    1.  Ìï¥Îãπ ÎßêÏùò Ï†ïÎ≥¥Î•º ÌÜ†ÎåÄÎ°ú ÏÉàÎ°ú Ïù¥ÎèôÌï† ÏúÑÏπòÎ•º ÌôïÏù∏ÌïúÎã§
    1.  Ìï¥Îãπ ÏúÑÏπòÍ∞Ä Ïñ¥Îñ§ ÏÉâÏù∏ÏßÄ ÌôïÏù∏ÌïúÎã§
        1.  Ìù∞ÏÉâÏù∏ Í≤ΩÏö∞
            1.  ÏÉàÎ°ú Ïù¥ÎèôÌï† Ïπ∏Ïóê Îã§Î•∏ ÎßêÏù¥ ÏûàÎäîÏßÄ ÌôïÏù∏ ÌõÑ, ÌòÑÏû¨ ÎßêÏù¥ ÏúÑÏπòÌï† Ïàò ÏûàÎäî Ï∏µÏùÑ Íµ¨ÌïúÎã§
            1.  Ìï¥Îãπ Ï∏µÏúºÎ°ú Ïù¥ÎèôÌïú ÌõÑ, Ï¶âÏãú node_loc Í∞ùÏ≤¥Ïùò Í∞íÏùÑ Í∞±Ïã†Ìï¥Ï§ÄÎã§ (Ï∏µÍ≥º ÌñâÏó¥ ÏúÑÏπò)
            1.  ÌòÑÏû¨ Îßê ÏúÑÏóê ÏûàÏóàÎçò ÎßêÎì§ÎèÑ Ïù¥ÎèôÏãúÏºúÏ§ÄÎã§
            1.  ÌòÑÏû¨ ÎßêÏùò ÏÉàÎ°úÏö¥ Ï∏µ ÏàòÏóê 1Ïî© ÎçîÌï¥Ï£ºÎ©¥ÏÑú Ïù¥ÎèôÏãúÌÇ®Îã§
            1.  Ïù¥ÎèôÏãúÌÇ® ÎßêÏùò ÏõêÎûò ÏúÑÏπòÎäî 0ÏúºÎ°ú Ï¥àÍ∏∞ÌôîÌïúÎã§
            1.  Ïù¥ÎèôÌïòÎ©¥ÏÑú Ï∏µÏàòÍ∞Ä 4Ï∏µÏù¥Î©¥ Ï°∞Í±¥ÏùÑ ÎßåÏ°±ÌïòÎØÄÎ°ú Ï¢ÖÎ£åÌïúÎã§

        1.  Îπ®Í∞ïÏÉâÏù∏ Í≤ΩÏö∞
            1.  ÏÉàÎ°ú Ïù¥ÎèôÌï† Ïπ∏Ïóê Îã§Î•∏ ÎßêÏù¥ ÏûàÎäîÏßÄ ÌôïÏù∏ ÌõÑ, ÌòÑÏû¨ ÎßêÏù¥ ÏúÑÏπòÌï† Ïàò ÏûàÎäî Ï∏µÏùÑ Íµ¨ÌïúÎã§
            1.  Ìï¥Îãπ Ï∏µÏúºÎ°ú Ïù¥ÎèôÌï† Îïå, Ïó≠ÏàúÏúºÎ°ú Ïù¥ÎèôÌï¥ÏïºÌïòÎØÄÎ°ú ÌòÑÏû¨ Îßê ÏúÑÏóê Î™áÍ∞úÏùò ÎßêÏù¥ ÏûàÏóàÎäîÏßÄ ÌôïÏù∏ÌïúÎã§
            1.  ÏÉàÎ°ú Ïù¥ÎèôÌï† Ïπ∏Ïùò Ï†úÏùº ÎÇÆÏùÄ Ï∏µÏóêÎäî ÏõêÎûò ÏûàÏóàÎçò Í≥≥Ïùò Ï†úÏùº ÎÜíÏùÄ Í≥≥Ïóê ÏúÑÏπòÌïú ÎßêÏù¥ Ïù¥ÎèôÌïúÎã§. 
            1.  Ïù¥Îèô ÌõÑ Ï¶âÏãú Í∞±Ïã†Ìï¥Ï§òÏïºÌïòÎäî Ìñâ,Ïó¥,Ï∏µ Í∞íÏùÑ Í∞±Ïã†Ìï¥Ï§ÄÎã§
            1.  ÎßåÏïΩ Ï†úÏùº ÎÜíÏùÄ Ï∏µÏù¥ 4Ï∏µÏù¥ÎùºÎ©¥ Ï¢ÖÎ£åÌïúÎã§

        1.  ÌååÎûëÏù¥Í±∞ÎÇò Î≤îÏúÑÎ•º Î≤óÏñ¥ÎÇú Í≤ΩÏö∞
            1.  Ïö∞ÏÑ†, node Î∞∞Ïó¥Ïóê ÏûàÎçò blue_checkÎ•º ÌôïÏù∏ÌïúÎã§
            1.  Ìï¥Îãπ Í∞íÏù¥ 1Ïù¥Î©¥ Ïù¥ÎØ∏ Ïù¥Ï†ÑÏóê ÌååÎûëÏùÑ Í∞îÎã§ ÏôîÎã§Îäî Í≤É
                1.  Ïù¥ Í≤ΩÏö∞, Í∑∏ÎåÄÎ°ú nodesÏóê append Ìï¥Ï§ÄÎã§

            1.  Ìï¥Îãπ Í∞íÏù¥ 0Ïù¥Î©¥ Ï≤òÏùå ÌååÎûëÏóê ÏúÑÏπòÌïú Í≤ÉÏù¥ÎØÄÎ°ú Î∞©Ìñ•ÏùÑ Î≥ÄÍ≤ΩÌï¥Ï§ÄÎã§
                1.  Î∞©Ìñ• Î≥ÄÍ≤Ω ÌõÑ, appendleftÎ•º Ïù¥Ïö©Ìï¥ Îã§Ïãú ÎÑ£Ïñ¥Ï§ÄÎã§
                1.  Î∞©Ìñ• Î≥ÄÍ≤Ω ÌõÑ Î∞îÎ°ú Ïù¥ÎèôÏù¥ Í∞ÄÎä•ÌïòÎèÑÎ°ù ÌïòÍ∏∞ ÏúÑÌï®

1.  ÌïòÎÇòÏùò Îßê Ïù¥ÎèôÏù¥ ÏôÑÎ≤ΩÌûà ÎÅùÎÇòÎäî Í≤ΩÏö∞ turn Î≥ÄÏàòÏóê 1ÏùÑ ÎçîÌï¥Ï§ÄÎã§
1.  Ï¢ÖÎ£å Ï°∞Í±¥Ïóê ÎßûÍ≤å ÎêòÎ©¥ turnÏùÑ ÎßêÏùò Í∞úÏàòÎ°ú ÎÇòÎà†ÏÑú Ï¥ù Î™áÏ∞®Î°ÄÏùò ÌÑ¥Ïù¥ ÌïÑÏöîÌñàÎäîÏßÄ Íµ¨ÌïúÎã§
1.  turnÏùÑ ÎßêÏùò Í∞úÏàòÎ°ú ÎÇòÎàà Í∞íÏù¥ 1000ÏùÑ ÎÑòÏúºÎ©¥ -1ÏùÑ Ï∂úÎ†•ÌïòÍ≥† Ï¢ÖÎ£åÌïúÎã§.



#### üíªÏΩîÎìú

```python
from collections import deque
import sys
input = sys.stdin.readline

N,K = map(int,input().split())
# NÍ∞úÏùò ÌñâÎ†¨Ï†ïÎ≥¥
arr = [list(map(int,input().split())) for _ in range(N)]

# nodesÏóêÎäî Í∞ôÏù¥ Ïù¥ÎèôÌï† Îïå Í∞±Ïã†ÌïòÏßÄ ÏïäÏïÑÎèÑ ÎêòÎäî Í∞í
nodes = deque([])
# node_locÏóêÎäî Í∞ôÏù¥ Ïù¥ÎèôÌï† Í≤ΩÏö∞ Î∞îÎ°ú Í∞±Ïã†ÎêòÏñ¥ÏïºÌïòÎäî Í∞í
node_loc = {}

# kÍ∞úÏùò ÎÖ∏Îìú Ï†ïÎ≥¥ (ÌòÑÏû¨ÏúÑÏπò, Î∞©Ìñ•)
for k in range(K):
    n,m,direction = map(int,input().split())
    # ÎÖ∏Îìú Î≤àÌò∏, Î∞©Ìñ•, ÌååÎûë
    nodes.append([k+1,direction,0])
    # Ìñâ ÏúÑÏπò, Ïó¥ ÏúÑÏπò, Ï∏µ
    node_loc[k+1] = [n-1,m-1,0]

# 3Ï∞®Ïõê ÌñâÎ†¨
arr_node = [[[0]*N for _ in range(N)] for _ in range(N)]
delta = [(0,0),(0,1),(0,-1),(-1,0),(1,0)]

# ÌòÑÏû¨ ÎÖ∏ÎìúÎì§Ïùò ÏúÑÏπòÎ•º Îßµ ÏÉÅÏóê ÎÇòÌÉÄÎÇ¥Í∏∞
# Ï≤òÏùåÎ∂ÄÌÑ∞ Í∞ôÏùÄ ÏúÑÏπòÏù∏ Í≤ΩÏö∞ ÏóÜÏùå
for node in nodes:
    arr_node[0][node_loc[node[0]][0]][node_loc[node[0]][1]] = node[0]

turn = K
while nodes:
    # ÌÑ¥ ÏàòÍ∞Ä 1000ÏùÑ ÎÑòÍ∏∞Î©¥ -1 Ï∂úÎ†•
    if turn//K>1000:
        print(-1)
        break

    node = nodes.popleft()
    key = node[0]
    direction = node[1]
    blue_chcek = node[2]

    x,y = node_loc[key][0],node_loc[key][1]
    floor = node_loc[key][2]

    # Ïù¥ÎèôÌïòÎ†§Îäî ÏúÑÏπò
    nx,ny = x+delta[direction][0],y+delta[direction][1]

    # Ïù¥ÎèôÌïòÎ†§Îäî ÏúÑÏπòÍ∞Ä Î≤îÏúÑ ÏïàÏóê ÏÜçÌïòÎäîÍ∞Ä
    if 0<=nx<N and 0<=ny<N:
        # ÏÉàÎ°úÏö¥ ÏúÑÏπòÍ∞Ä Ìù∞ÏÉâÏù¥ÎùºÎ©¥
        if arr[nx][ny] == 0:
            # Ïù¥ÎØ∏ ÏûàÎäî Îßê ÏúÑÏóêÎã§Í∞Ä ÏåìÏïÑÏ£ºÍ∏∞
            # iÏ∏µÏóê ÏûêÎ¶¨Î•º Ïû°Í≤åÎê®
            for i in range(N):
                # ÎßåÏïΩ iÏ∏µÏóê ÎßêÏù¥ ÏóÜÎã§Î©¥
                if arr_node[i][nx][ny] == 0:
                    # Ìï¥Îãπ Ï∏µÏù¥ ÌòÑÏû¨ Ïù¥ÎèôÌïòÎ†§Îäî ÎßêÏùò ÏúÑÏπò
                    arr_node[i][nx][ny] = key
                    # Ïù¥ÎèôÌñàÏúºÎØÄÎ°ú, ÎßêÏùò ÏúÑÏπòÏôÄ Ï∏µÏùÑ Í∞±Ïã†Ìï¥Ï§å
                    node_loc[key][0],node_loc[key][1],node_loc[key][2] = nx,ny,i
                    # ÏõêÎûò ÏúÑÏπòÎäî 0ÏúºÎ°ú Ï¥àÍ∏∞Ìôî
                    arr_node[floor][x][y] = 0
                    # ÎßåÏïΩ, Ï∏µÏù¥ 4Ï∏µ(Ïù∏Îç±Ïä§Î°úÎäî 3)Ïù¥Î©¥ Ï¢ÖÎ£å
                    if i == 3:
                        print(turn//K)
                        quit()
                    break
            # Îßê ÏúÑÏóê ÏûàÎçò Ïï†Îì§ Í∞ôÏù¥ ÏòÆÍ∏∞Í∏∞
            # Ï≤´ ÎßêÏùò ÏúÑÏπòÏù∏ iÏ∏µ ÏúÑÏóêÏÑúÎ∂ÄÌÑ∞ ÏåìÏïÑÏ£ºÍ∏∞
            l = 1
            # ÌòÑÏû¨ ÎßêÏùò ÏõêÎûò ÏúÑÏπòÏù∏ floor Îã§Ïùå Ï∏µÎ∂ÄÌÑ∞ ÏòÆÍ≤®Ï£ºÍ∏∞
            for j in range(floor+1,N):
                # 0Ïù¥ ÏïÑÎãàÎùºÎäî Í≤ÉÏùÄ ÎßêÏù¥ ÏûàÎã§Îäî Îúª
                if arr_node[j][x][y] != 0:
                    # iÏ∏µ ÏúÑÏóê Ïò¨Î†§Ï£ºÍ∏∞
                    arr_node[i+l][nx][ny] = arr_node[j][x][y]
                    # ÏúÑÏπòÏôÄ Ï∏µÏàò Î∞îÎ°ú Í∞±Ïã†Ìï¥Ï£ºÍ∏∞
                    node_loc[arr_node[j][x][y]][0],node_loc[arr_node[j][x][y]][1],node_loc[arr_node[j][x][y]][2] = nx,ny,i+l
                    # ÏõêÎûò ÏúÑÏπò Ï¥àÍ∏∞Ìôî
                    arr_node[j][x][y] = 0

                    # ÎßåÏïΩ Ï∏µ ÏàòÍ∞Ä 4Ï∏µÏù¥Î©¥ Ï¢ÖÎ£å
                    if i+l == 3:
                        print(turn//K)
                        quit()
                    l+=1

            # Î∞îÎÄêÍ∞íÏúºÎ°ú Îã§Ïãú ÎÑ£Ïñ¥Ï£ºÍ∏∞
            nodes.append([key,direction,0])
            # Ìïú ÎßêÏùò Ï∞®Î°Ä ÎÅù!
            turn+=1
            continue

        # ÏÉàÎ°úÏö¥ ÏúÑÏπòÍ∞Ä Îπ®Í∞ïÏù¥ÎùºÎ©¥
        if arr[nx][ny] == 1:
            top = floor
            # ÌòÑÏû¨ Îßê ÏúÑÏóê ÏûàÎäî Ï†úÏùº ÎÜíÏùÄ ÏúÑÏπò
            for loc in range(N-1,floor-1,-1):
                if arr_node[loc][x][y] != 0:
                    # ÌòÑÏû¨ Îßê ÏúÑ Ï†úÏùº ÎÜíÏùÄ ÏúÑÏπò loc
                    # ÏúÑÏóê ÏïÑÎ¨¥Í≤ÉÎèÑ ÏóÜÏúºÎ©¥ ÌòÑÏû¨ ÎßêÏùò ÏúÑÏπòÍ∞Ä Ï†úÏùº ÎÜíÏùÄ ÏúÑÏπòÎ°ú Ï†ÄÏû•
                    top = loc
                    break


            # ÏÉàÎ°ú Ïù¥ÎèôÌï† ÏúÑÏπòÏóê ÎßûÎäî Ï∏µ Ï∞æÍ∏∞
            for i in range(N):
                if arr_node[i][nx][ny] == 0:
                    # Îπ®Í∞ïÏπ∏Ïù¥ÎØÄÎ°ú Ïó≠ÏàúÏúºÎ°ú Î∞∞Ïπò
                    if top>=floor:
                        # iÏ∏µ Ï¶â, ÏÉàÎ°úÏö¥ ÏúÑÏπòÏùò Ï†úÏùº ÎÇÆÏùÄ Ï∏µÏùÄ Ïù¥Ï†Ñ ÏúÑÏπòÏóêÏÑú Ï†úÏùº ÎÜíÏùÄ ÏúÑÏπòÏóê ÏûàÎçò ÎßêÏù¥ Ï∞®ÏßÄ
                        arr_node[i][nx][ny] = arr_node[top][x][y]
                        # ÏúÑÏπòÍ∞íÍ≥º Ï∏µÏàò Í∞±Ïã†
                        node_loc[arr_node[top][x][y]][0],node_loc[arr_node[top][x][y]][1],node_loc[arr_node[top][x][y]][2] = nx,ny,i
                        # ÏõêÎûò ÏúÑÏπò Ï¥àÍ∏∞Ìôî
                        arr_node[top][x][y] = 0
                        # Îã§Ïùå Ï∏µÏùÑ ÏúÑÌï¥ top Í∞í Í∞±Ïã†
                        top-=1

                        # ÎßåÏïΩ ÏÉàÎ°úÏö¥ ÏúÑÏπòÍ∞Ä 4ÎùºÎ©¥ Ï¢ÖÎ£å
                        if i == 3:
                            print(turn//K)
                            quit()
                    else:
                        break

            # ÌòÑÏû¨ ÏõÄÏßÅÏù∏ ÎßêÏùÑ Ïù¥Ï†ú Îß® Îí§Î°ú ÎÑ£Ïñ¥Ï£ºÍ∏∞
            nodes.append([key,direction,0])
            # ÌòÑÏû¨ ÏõÄÏßÅÏù∏ ÎßêÏùÑ Îã§ ÏòÆÍ≤ºÏúºÎãà ÎÅù!
            turn+=1
            continue

    # ÎßåÏïΩ ÌååÎûëÏÉâÏù¥Í±∞ÎÇò, Î≤îÏúÑÎ•º Î≤óÏñ¥ÎÇú Í≤ΩÏö∞
    # ÌååÎûëÏùÑ Ïù¥ÎØ∏ Í∞îÎã§ Ïò®Í±¥ÏßÄ ÏïÑÎãåÏßÄ ÌåêÎã®Ìï† blue_check
    # Ïù¥Î≤àÏóê Ï≤òÏùå ÌååÎûëÏù¥Í±∞ÎÇò Î≤îÏúÑÎ•º Î≤óÏñ¥ÎÇ¨Îã§Î©¥
    # Î∞©Ìñ• Î≥ÄÍ≤ΩÌï¥Ï£ºÍ∏∞
    if blue_chcek == 0:
        if direction == 1:
            direction = 2
        elif direction == 2:
            direction = 1
        elif direction == 3:
            direction = 4
        else:
            direction = 3

        # Í∑∏Î¶¨Í≥† Îã§Ïãú Í∑∏ ÏÉàÎ°úÏö¥ ÏúÑÏπòÎ°ú Ïù¥ÎèôÌï¥ÏïºÌïòÎØÄÎ°ú appendleft ÏÇ¨Ïö©
        # Ïù¥ÎØ∏ ÌååÎûëÏùÑ ÌïúÎ≤à Îã§ÎÖÄÏò® ÏÉÅÌÉúÏù¥ÎØÄÎ°ú blue_checkÎäî 1Î°ú Î≥ÄÍ≤Ω
        nodes.appendleft([key,direction,1])
    else:
        # ÎßåÏïΩ ÎëêÎ≤àÏß∏ ÌååÎûëÏù¥Í±∞ÎÇò Î≤îÏúÑÎ•º Î≤óÏñ¥ÎÇ¨Îã§Î©¥, Í∑∏ ÏúÑÏπò Í∑∏ÎåÄÎ°ú ÏïÑÎ¨¥Í≤ÉÎèÑ ÏïàÌï®
        # blue_checkÎ•º 0ÏúºÎ°ú, Í∑∏Î¶¨Í≥† ÌòÑÏû¨ ÏúÑÏπò Í∞±Ïã†X
        nodes.append([key,direction,0])
        # Ïù¥Î≤à ÎßêÏùÄ ÎÅù
        turn+=1
```



#### ‚ùå Î∞úÏÉù Ïò§Î•ò Î∞è Ìï¥Í≤∞

- forÎ¨∏ Ïó≠ÏàúÌöåÏãú ÎßàÏßÄÎßâÏóê -1 Ïïà ÎÑ£ÏùÄ Ïã§Ïàò
- Í≤åÏûÑÏùò Ï¢ÖÎ£å ÏãúÏ†êÏùÄ Ìïú Ïπ∏Ïóê Îßê 4Í∞úÍ∞Ä ÏûàÎäî Í≤ΩÏö∞Ïù∏Îç∞, Î™®Îì† ÎßêÏù¥ ÏûàÏñ¥ÏïºÎêòÎäî Í≤ÉÏúºÎ°ú Ï∞©Í∞Å
  - Ï¢ÖÎ£å Ï°∞Í±¥ÏùÑ ÏûòÎ™ª ÏÑ§Ï†ï
